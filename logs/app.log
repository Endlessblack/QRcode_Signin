2025-08-28 14:44:11,351 [INFO] app: 相機已啟動（索引 0）
2025-08-28 14:44:46,840 [INFO] app: 偵測到 QR：{'id': '00001', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4564.com', 'Salon': '46546', 'licence': '
2025-08-28 14:45:09,364 [INFO] app: 相機已停止
2025-08-28 14:45:10,410 [INFO] app: 相機已啟動（索引 0）
2025-08-28 14:45:28,327 [INFO] app: 相機已停止
2025-08-28 14:45:30,046 [INFO] app: 相機已啟動（索引 0）
2025-08-28 14:51:11,404 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 14:51:24,456 [INFO] app: 相機已啟動（索引 0）
2025-08-28 14:52:50,804 [INFO] app: 相機已停止
2025-08-28 14:52:52,138 [INFO] app: 相機已啟動（索引 0）
2025-08-28 14:53:02,359 [INFO] app: 偵測到 QR：{'id': '00002', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4565.com', 'Salon': '46546', 'licence': '
2025-08-28 14:53:02,362 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 14:53:02,366 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 14:53:03,411 [ERROR] app: [API] Append failed: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 155, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [403]: The caller does not have permission

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 39, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 42, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 19, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 160, in open_by_key
    raise PermissionError from ex
PermissionError

2025-08-28 14:53:03,438 [INFO] app: [API] 失敗：Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 155, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [403]: The caller does not have permission

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 39, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 42, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 19, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 160, in open_by_key
    raise PermissionError from ex
PermissionError

2025-08-28 14:53:08,357 [INFO] app: [API] 寫入逾時，重置掃描狀態（6s）
2025-08-28 14:57:57,668 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 14:59:43,380 [INFO] app: 相機已啟動（索引 0）
2025-08-28 14:59:49,687 [INFO] app: 偵測到 QR：{'id': '00002', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4565.com', 'Salon': '46546', 'licence': '
2025-08-28 14:59:49,691 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 14:59:49,696 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 14:59:53,738 [INFO] app: [API] Append success for id=00002 name=4156456
2025-08-28 14:59:53,756 [INFO] app: [API] 成功寫入：id=00002, name=4156456
2025-08-28 15:00:00,587 [INFO] app: 偵測到 QR：{'id': '00003', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4566.com', 'Salon': '46546', 'licence': '
2025-08-28 15:00:00,589 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:00:00,596 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:00:03,290 [INFO] app: [API] Append success for id=00003 name=4156456
2025-08-28 15:00:03,325 [INFO] app: [API] 成功寫入：id=00003, name=4156456
2025-08-28 15:00:04,820 [INFO] app: 偵測到 QR：{'id': '00005', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4568.com', 'Salon': '46546', 'licence': '
2025-08-28 15:00:04,822 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:00:04,825 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:00:07,440 [INFO] app: [API] Append success for id=00005 name=4156456
2025-08-28 15:00:07,455 [INFO] app: [API] 成功寫入：id=00005, name=4156456
2025-08-28 15:00:16,404 [INFO] app: 偵測到 QR：{'id': '00007', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4570.com', 'Salon': '46546', 'licence': '
2025-08-28 15:00:16,404 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:00:16,406 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:00:18,561 [INFO] app: [API] Append success for id=00007 name=4156456
2025-08-28 15:00:18,570 [INFO] app: [API] 成功寫入：id=00007, name=4156456
2025-08-28 15:00:25,664 [INFO] app: 偵測到 QR：{'id': '00008', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4571.com', 'Salon': '46546', 'licence': '
2025-08-28 15:00:25,666 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:00:25,669 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:00:29,964 [INFO] app: [API] Append success for id=00008 name=4156456
2025-08-28 15:00:29,992 [INFO] app: [API] 成功寫入：id=00008, name=4156456
2025-08-28 15:00:37,235 [INFO] app: 偵測到 QR：{'id': '00010', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4573.com', 'Salon': '46546', 'licence': '
2025-08-28 15:00:37,238 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:00:37,242 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:00:39,382 [INFO] app: [API] Append success for id=00010 name=4156456
2025-08-28 15:00:39,394 [INFO] app: [API] 成功寫入：id=00010, name=4156456
2025-08-28 15:01:24,774 [INFO] app: 相機已停止
2025-08-28 15:02:52,134 [INFO] app: 相機已停止
2025-08-28 15:08:08,525 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 15:08:22,007 [INFO] app: 相機已啟動（索引 0）
2025-08-28 15:10:00,768 [INFO] app: 相機已停止
2025-08-28 15:10:08,398 [INFO] app: 相機已啟動（索引 0）
2025-08-28 15:11:08,506 [INFO] app: 相機已停止
2025-08-28 15:12:21,014 [INFO] app: 相機已啟動（索引 0）
2025-08-28 15:12:49,503 [INFO] app: 相機已停止
2025-08-28 15:12:54,750 [INFO] app: 相機已啟動（索引 0）
2025-08-28 15:14:14,954 [INFO] app: 相機已停止
2025-08-28 15:14:24,425 [INFO] app: 相機已啟動（索引 0）
2025-08-28 15:20:50,938 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 15:21:14,837 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 15:26:21,789 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 15:26:36,031 [INFO] app: 相機已啟動（索引 0）
2025-08-28 15:27:02,955 [INFO] app: 偵測到 QR：{'id': '00001', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4564.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:02,960 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:27:02,965 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:02,973 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:03,887 [INFO] app: 偵測到 QR：{'id': '00001', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4564.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:03,890 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:27:06,217 [INFO] app: [API] Append success for id=00001 name=4156456
2025-08-28 15:27:06,276 [INFO] app: [API] 成功寫入：id=00001, name=4156456
2025-08-28 15:27:06,332 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:06,338 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:09,111 [INFO] app: [API] Append success for id=00001 name=4156456
2025-08-28 15:27:09,160 [INFO] app: [API] 成功寫入：id=00001, name=4156456
2025-08-28 15:27:10,162 [INFO] app: 偵測到 QR：{'id': '00002', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4565.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:10,166 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:27:10,169 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:10,174 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:11,078 [INFO] app: 偵測到 QR：{'id': '00002', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4565.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:11,082 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:27:12,043 [INFO] app: 偵測到 QR：{'id': '00003', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4566.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:12,046 [INFO] app: 已加入佇列，待寫入（佇列長度 2）
2025-08-28 15:27:12,984 [INFO] app: 偵測到 QR：{'id': '00004', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4567.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:12,988 [INFO] app: 已加入佇列，待寫入（佇列長度 3）
2025-08-28 15:27:13,325 [INFO] app: [API] Append success for id=00002 name=4156456
2025-08-28 15:27:13,346 [INFO] app: [API] 成功寫入：id=00002, name=4156456
2025-08-28 15:27:13,391 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:13,400 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:13,859 [INFO] app: 偵測到 QR：{'id': '00005', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4568.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:13,860 [INFO] app: 已加入佇列，待寫入（佇列長度 3）
2025-08-28 15:27:14,754 [INFO] app: 偵測到 QR：{'id': '00005', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4568.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:14,755 [INFO] app: 已加入佇列，待寫入（佇列長度 4）
2025-08-28 15:27:15,484 [INFO] app: [API] Append success for id=00002 name=4156456
2025-08-28 15:27:15,490 [INFO] app: [API] 成功寫入：id=00002, name=4156456
2025-08-28 15:27:15,492 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:15,495 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:15,594 [INFO] app: 偵測到 QR：{'id': '00006', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4569.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:15,595 [INFO] app: 已加入佇列，待寫入（佇列長度 4）
2025-08-28 15:27:16,470 [INFO] app: 偵測到 QR：{'id': '00007', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4570.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:16,471 [INFO] app: 已加入佇列，待寫入（佇列長度 5）
2025-08-28 15:27:17,414 [INFO] app: 偵測到 QR：{'id': '00008', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4571.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:17,417 [INFO] app: 已加入佇列，待寫入（佇列長度 6）
2025-08-28 15:27:17,479 [INFO] app: [API] Append success for id=00003 name=4156456
2025-08-28 15:27:17,510 [INFO] app: [API] 成功寫入：id=00003, name=4156456
2025-08-28 15:27:17,522 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:17,527 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:18,266 [INFO] app: 偵測到 QR：{'id': '00009', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4572.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:18,267 [INFO] app: 已加入佇列，待寫入（佇列長度 6）
2025-08-28 15:27:19,153 [INFO] app: 偵測到 QR：{'id': '00010', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4573.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:19,156 [INFO] app: 已加入佇列，待寫入（佇列長度 7）
2025-08-28 15:27:20,089 [INFO] app: [API] Append success for id=00004 name=4156456
2025-08-28 15:27:20,119 [INFO] app: 偵測到 QR：{'id': '00011', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4574.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:20,126 [INFO] app: 已加入佇列，待寫入（佇列長度 8）
2025-08-28 15:27:20,131 [INFO] app: [API] 成功寫入：id=00004, name=4156456
2025-08-28 15:27:20,167 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:20,178 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:20,987 [INFO] app: 偵測到 QR：{'id': '00012', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4575.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:20,987 [INFO] app: 已加入佇列，待寫入（佇列長度 8）
2025-08-28 15:27:21,948 [INFO] app: 偵測到 QR：{'id': '00013', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4576.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:21,951 [INFO] app: 已加入佇列，待寫入（佇列長度 9）
2025-08-28 15:27:22,469 [INFO] app: [API] Append success for id=00005 name=4156456
2025-08-28 15:27:22,503 [INFO] app: [API] 成功寫入：id=00005, name=4156456
2025-08-28 15:27:22,535 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:22,537 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:22,785 [INFO] app: 偵測到 QR：{'id': '00014', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4577.com', 'Salon': '46546', 'licence': '
2025-08-28 15:27:22,786 [INFO] app: 已加入佇列，待寫入（佇列長度 9）
2025-08-28 15:27:23,653 [INFO] app: 偵測到 QR：{'id': '', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4581.com', 'Salon': '46546'}}
2025-08-28 15:27:23,655 [INFO] app: 已加入佇列，待寫入（佇列長度 10）
2025-08-28 15:27:24,498 [INFO] app: 偵測到 QR：{'id': '', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4581.com', 'Salon': '46546'}}
2025-08-28 15:27:24,499 [INFO] app: 已加入佇列，待寫入（佇列長度 11）
2025-08-28 15:27:24,663 [INFO] app: [API] Append success for id=00005 name=4156456
2025-08-28 15:27:24,708 [INFO] app: [API] 成功寫入：id=00005, name=4156456
2025-08-28 15:27:24,744 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:24,754 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:25,425 [INFO] app: 偵測到 QR：{'id': '', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4581.com', 'Salon': '46546'}}
2025-08-28 15:27:25,430 [INFO] app: 已加入佇列，待寫入（佇列長度 11）
2025-08-28 15:27:26,333 [INFO] app: 偵測到 QR：{'id': '', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4581.com', 'Salon': '46546'}}
2025-08-28 15:27:26,334 [INFO] app: 已加入佇列，待寫入（佇列長度 12）
2025-08-28 15:27:27,554 [INFO] app: [API] Append success for id=00006 name=4156456
2025-08-28 15:27:27,560 [INFO] app: [API] 成功寫入：id=00006, name=4156456
2025-08-28 15:27:27,569 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:27,573 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:30,012 [INFO] app: [API] Append success for id=00007 name=4156456
2025-08-28 15:27:30,018 [INFO] app: [API] 成功寫入：id=00007, name=4156456
2025-08-28 15:27:30,022 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:30,024 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:31,932 [INFO] app: [API] Append success for id=00008 name=4156456
2025-08-28 15:27:31,933 [INFO] app: [API] 成功寫入：id=00008, name=4156456
2025-08-28 15:27:31,936 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:31,939 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:33,926 [INFO] app: [API] Append success for id=00009 name=4156456
2025-08-28 15:27:33,953 [INFO] app: [API] 成功寫入：id=00009, name=4156456
2025-08-28 15:27:33,966 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:33,979 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:36,463 [INFO] app: [API] Append success for id=00010 name=4156456
2025-08-28 15:27:36,525 [INFO] app: [API] 成功寫入：id=00010, name=4156456
2025-08-28 15:27:36,533 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:36,542 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:38,776 [INFO] app: [API] Append success for id=00011 name=4156456
2025-08-28 15:27:38,778 [INFO] app: [API] 成功寫入：id=00011, name=4156456
2025-08-28 15:27:38,780 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:38,782 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:40,899 [INFO] app: [API] Append success for id=00012 name=4156456
2025-08-28 15:27:40,906 [INFO] app: [API] 成功寫入：id=00012, name=4156456
2025-08-28 15:27:40,945 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:40,950 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:43,720 [INFO] app: [API] Append success for id=00013 name=4156456
2025-08-28 15:27:43,745 [INFO] app: [API] 成功寫入：id=00013, name=4156456
2025-08-28 15:27:43,749 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:43,750 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:45,687 [INFO] app: [API] Append success for id=00014 name=4156456
2025-08-28 15:27:45,701 [INFO] app: [API] 成功寫入：id=00014, name=4156456
2025-08-28 15:27:45,796 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:45,801 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:48,802 [INFO] app: [API] Append success for id= name=4156456
2025-08-28 15:27:48,806 [INFO] app: [API] 成功寫入：id=, name=4156456
2025-08-28 15:27:48,812 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:48,818 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:50,916 [INFO] app: [API] Append success for id= name=4156456
2025-08-28 15:27:50,928 [INFO] app: [API] 成功寫入：id=, name=4156456
2025-08-28 15:27:50,987 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:50,994 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:52,996 [INFO] app: [API] Append success for id= name=4156456
2025-08-28 15:27:53,020 [INFO] app: [API] 成功寫入：id=, name=4156456
2025-08-28 15:27:53,076 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:27:53,103 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:27:57,144 [INFO] app: [API] Append success for id= name=4156456
2025-08-28 15:27:57,163 [INFO] app: [API] 成功寫入：id=, name=4156456
2025-08-28 15:29:49,305 [INFO] app: 偵測到 QR：{'id': '', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4581.com', 'Salon': '46546'}}
2025-08-28 15:29:49,308 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:29:49,310 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:29:49,315 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:29:53,424 [INFO] app: [API] Append success for id= name=4156456
2025-08-28 15:29:53,438 [INFO] app: [API] 成功寫入：id=, name=4156456
2025-08-28 15:30:03,091 [INFO] app: 偵測到 QR：{'id': '', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4581.com', 'Salon': '46546'}}
2025-08-28 15:30:03,092 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:30:03,094 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:30:03,095 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:30:05,195 [INFO] app: [API] Append success for id= name=4156456
2025-08-28 15:30:05,219 [INFO] app: [API] 成功寫入：id=, name=4156456
2025-08-28 15:30:05,531 [INFO] app: 偵測到 QR：{'id': '', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4581.com', 'Salon': '46546'}}
2025-08-28 15:30:05,532 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:30:05,533 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:30:05,535 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:30:07,678 [INFO] app: [API] Append success for id= name=4156456
2025-08-28 15:30:07,679 [INFO] app: [API] 成功寫入：id=, name=4156456
2025-08-28 15:30:23,974 [INFO] app: 偵測到 QR：{'id': '00009', 'name': '4156456', 'event': 'test', 'extra': {'email': '456456@4572.com', 'Salon': '46546', 'licence': '
2025-08-28 15:30:23,976 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:30:23,977 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:30:23,979 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:30:27,498 [INFO] app: [API] Append success for id=00009 name=4156456
2025-08-28 15:30:27,532 [INFO] app: [API] 成功寫入：id=00009, name=4156456
2025-08-28 15:34:46,804 [INFO] app: 偵測到 QR：{'id': '00001', 'name': '大明', 'event': '活動', 'extra': {'email': '123@gmail.com', 'Salon': 'test01', 'Licence': 'year'}}
2025-08-28 15:34:46,806 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:34:46,809 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:34:46,814 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:34:50,992 [INFO] app: [API] Append success for id=00001 name=大明
2025-08-28 15:34:51,138 [INFO] app: [API] 成功寫入：id=00001, name=大明
2025-08-28 15:34:52,480 [INFO] app: 偵測到 QR：{'id': '00002', 'name': '小明', 'event': '活動', 'extra': {'email': '124@gmail.com', 'Salon': 'test02', 'Licence': 'moth'}}
2025-08-28 15:34:52,484 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:34:52,485 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:34:52,488 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:34:54,864 [INFO] app: [API] Append success for id=00002 name=小明
2025-08-28 15:34:54,907 [INFO] app: [API] 成功寫入：id=00002, name=小明
2025-08-28 15:34:55,087 [INFO] app: 偵測到 QR：{'id': '00003', 'name': '小王', 'event': '活動', 'extra': {'email': '125@gmail.com', 'Salon': 'test03', 'Licence': 'day'}}
2025-08-28 15:34:55,089 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:34:55,092 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:34:55,096 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:34:57,244 [INFO] app: 偵測到 QR：{'id': '00004', 'name': '大王', 'event': '活動', 'extra': {'email': '126@gmail.com', 'Salon': 'test04', 'Licence': 'week'}}
2025-08-28 15:34:57,246 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-28 15:34:57,945 [INFO] app: [API] Append success for id=00003 name=小王
2025-08-28 15:34:57,963 [INFO] app: [API] 成功寫入：id=00003, name=小王
2025-08-28 15:34:58,027 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-28 15:34:58,031 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-28 15:35:00,232 [INFO] app: [API] Append success for id=00004 name=大王
2025-08-28 15:35:00,240 [INFO] app: [API] 成功寫入：id=00004, name=大王
2025-08-28 15:58:25,104 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 16:04:11,226 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 16:06:40,807 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 16:10:16,544 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 16:30:21,875 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 16:31:29,259 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 16:42:28,857 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:00:25,450 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:07:25,866 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:12:34,179 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:17:02,453 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:31:38,067 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:39:28,038 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:49:31,537 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:50:49,276 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 17:51:01,790 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 20:52:20,485 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:02:31,699 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:03:30,132 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:16:18,630 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:17:03,143 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:17:51,301 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:23:59,062 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:25:06,928 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:38:36,760 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 21:44:13,166 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 22:05:25,634 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 22:09:29,487 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 22:33:35,641 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 22:44:22,601 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 22:49:51,480 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 22:50:00,629 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 22:50:12,978 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:13:48,736 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:14:01,561 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:14:08,704 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:15:35,324 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:17:38,392 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:32:32,917 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:45:12,943 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:52:42,357 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:53:33,532 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:58:31,260 [DEBUG] app: Logging initialized. Debug=True
2025-08-28 23:59:34,197 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 00:00:30,851 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 09:47:40,553 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:03:11,520 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:07:43,065 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:12:41,980 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:17:16,625 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:22:16,785 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:24:44,982 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:25:15,656 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:33:09,419 [INFO] app: 相機已啟動（索引 0）
2025-08-29 10:50:22,688 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 10:56:27,138 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 11:23:40,334 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 11:35:25,006 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 11:38:46,122 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 11:59:31,250 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 12:30:44,244 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 12:33:21,183 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 12:34:27,679 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 12:37:50,982 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 12:38:07,551 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 12:38:20,524 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 13:35:34,224 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 13:37:34,791 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 13:42:41,714 [INFO] app: 相機已啟動（索引 0）
2025-08-29 13:43:52,593 [INFO] app: 相機已停止
2025-08-29 13:45:24,837 [INFO] app: 相機已停止
2025-08-29 13:45:34,183 [INFO] app: 相機已啟動（索引 1）
2025-08-29 13:45:49,230 [INFO] app: 相機已停止
2025-08-29 13:45:58,088 [INFO] app: 相機已啟動（索引 0）
2025-08-29 13:46:03,610 [INFO] app: 相機已停止
2025-08-29 13:46:04,753 [INFO] app: 相機已啟動（索引 0）
2025-08-29 13:46:10,237 [INFO] app: 相機已停止
2025-08-29 13:46:22,715 [INFO] app: 相機已啟動（索引 1）
2025-08-29 13:46:30,234 [INFO] app: 相機已停止
2025-08-29 13:46:36,854 [INFO] app: 相機已啟動（索引 0）
2025-08-29 13:46:46,790 [INFO] app: 相機已停止
2025-08-29 13:46:56,581 [INFO] app: 相機已啟動（索引 1）
2025-08-29 13:47:03,653 [INFO] app: 相機已停止
2025-08-29 13:47:18,786 [INFO] app: 相機已啟動（索引 0）
2025-08-29 13:48:39,862 [INFO] app: 相機已停止
2025-08-29 13:48:54,645 [INFO] app: 相機已啟動（索引 1）
2025-08-29 13:50:18,944 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 13:50:36,166 [INFO] app: 相機已啟動（索引 0）
2025-08-29 13:50:49,258 [INFO] app: 偵測到 QR：{'id': '000002', 'name': 'Olivia', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Luxe Locks Studio', 'Licence': 
2025-08-29 13:50:49,259 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 13:50:49,260 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 13:50:49,261 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 13:52:07,954 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 13:52:32,605 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 13:52:39,350 [INFO] app: 相機已停止
2025-08-29 13:52:42,553 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 13:53:01,968 [INFO] app: 偵測到 QR：{'id': '000002', 'name': 'Olivia', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Luxe Locks Studio', 'Licence': 
2025-08-29 13:53:01,969 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 13:53:01,970 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 13:53:01,972 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 13:53:38,591 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 13:53:46,650 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 13:53:57,584 [INFO] app: 相機已停止
2025-08-29 13:53:58,550 [INFO] app: 開始上傳離線資料...
2025-08-29 13:54:09,988 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 13:54:18,345 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 13:54:26,986 [INFO] app: 相機已停止
2025-08-29 13:54:35,545 [INFO] app: 相機已啟動（索引 1），解析度：1280x720
2025-08-29 13:54:55,749 [INFO] app: 相機已停止
2025-08-29 13:54:58,194 [INFO] app: 相機已啟動（索引 1），解析度：1280x720
2025-08-29 13:55:12,688 [INFO] app: 相機已停止
2025-08-29 13:55:15,474 [INFO] app: 相機已啟動（索引 1），解析度：1280x720
2025-08-29 13:55:31,230 [INFO] app: 相機已停止
2025-08-29 13:55:32,032 [INFO] app: 相機已停止
2025-08-29 13:55:34,437 [INFO] app: 相機已啟動（索引 1），解析度：1280x720
2025-08-29 13:55:50,284 [INFO] app: 相機已停止
2025-08-29 13:56:00,460 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 13:56:23,072 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 13:56:35,045 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 13:56:40,423 [INFO] app: 相機已停止
2025-08-29 13:56:52,037 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 13:57:03,170 [INFO] app: 相機已停止
2025-08-29 13:57:07,382 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 13:57:16,450 [INFO] app: 相機已停止
2025-08-29 13:57:52,017 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 13:59:59,266 [INFO] app: 開始上傳離線資料...
2025-08-29 14:02:03,976 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 14:02:13,319 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:02:32,709 [INFO] app: 相機已停止
2025-08-29 14:02:34,898 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:02:39,356 [INFO] app: 相機已停止
2025-08-29 14:02:48,343 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:02:57,120 [INFO] app: 相機已停止
2025-08-29 14:02:59,756 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:03:11,157 [INFO] app: 偵測到 QR：{'id': '000002', 'name': 'Olivia', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Luxe Locks Studio', 'Licence': 
2025-08-29 14:03:11,159 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:03:11,163 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:03:11,168 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:03:15,619 [INFO] app: [API] Append success for id=000002 name=Olivia
2025-08-29 14:03:15,628 [INFO] app: [API] 成功寫入：id=000002, name=Olivia
2025-08-29 14:03:21,508 [INFO] app: 偵測到 QR：{'id': '000002', 'name': 'Olivia', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Luxe Locks Studio', 'Licence': 
2025-08-29 14:03:21,510 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:03:21,512 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:03:21,517 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:03:24,349 [INFO] app: [API] Append success for id=000002 name=Olivia
2025-08-29 14:03:24,350 [INFO] app: [API] 成功寫入：id=000002, name=Olivia
2025-08-29 14:03:33,171 [INFO] app: 偵測到 QR：{'id': '000004', 'name': 'Harper', 'event': '活動', 'extra': {'SELLER': 'Doge', 'SALON': 'Velvet Tresses Salon', 'Licence'
2025-08-29 14:03:33,172 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:03:33,174 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:03:33,178 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:03:36,047 [INFO] app: [API] Append success for id=000004 name=Harper
2025-08-29 14:03:36,057 [INFO] app: [API] 成功寫入：id=000004, name=Harper
2025-08-29 14:03:38,745 [INFO] app: 偵測到 QR：{'id': '000005', 'name': 'Lucas', 'event': '活動', 'extra': {'SELLER': 'Doge', 'SALON': 'Velvet Tresses Salon', 'Licence':
2025-08-29 14:03:38,748 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:03:38,751 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:03:38,759 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:03:41,285 [INFO] app: [API] Append success for id=000005 name=Lucas
2025-08-29 14:03:41,294 [INFO] app: [API] 成功寫入：id=000005, name=Lucas
2025-08-29 14:03:43,846 [INFO] app: 偵測到 QR：{'id': '000005', 'name': 'Lucas', 'event': '活動', 'extra': {'SELLER': 'Doge', 'SALON': 'Velvet Tresses Salon', 'Licence':
2025-08-29 14:03:43,848 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:03:43,848 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:03:43,852 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:03:46,098 [INFO] app: [API] Append success for id=000005 name=Lucas
2025-08-29 14:03:46,118 [INFO] app: [API] 成功寫入：id=000005, name=Lucas
2025-08-29 14:03:49,393 [INFO] app: 偵測到 QR：{'id': '000005', 'name': 'Lucas', 'event': '活動', 'extra': {'SELLER': 'Doge', 'SALON': 'Velvet Tresses Salon', 'Licence':
2025-08-29 14:03:49,395 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:03:49,397 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:03:49,399 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:03:51,735 [INFO] app: [API] Append success for id=000005 name=Lucas
2025-08-29 14:03:51,766 [INFO] app: [API] 成功寫入：id=000005, name=Lucas
2025-08-29 14:03:54,684 [INFO] app: 偵測到 QR：{'id': '000006', 'name': 'Amelia', 'event': '活動', 'extra': {'SELLER': 'Doge', 'SALON': 'Velvet Tresses Salon', 'Licence'
2025-08-29 14:03:54,688 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:03:54,691 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:03:54,696 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:03:58,818 [INFO] app: [API] Append success for id=000006 name=Amelia
2025-08-29 14:03:58,836 [INFO] app: [API] 成功寫入：id=000006, name=Amelia
2025-08-29 14:04:00,734 [INFO] app: 偵測到 QR：{'id': '000006', 'name': 'Amelia', 'event': '活動', 'extra': {'SELLER': 'Doge', 'SALON': 'Velvet Tresses Salon', 'Licence'
2025-08-29 14:04:00,736 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:04:00,738 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:04:00,741 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:04:01,610 [INFO] app: 偵測到 QR：{'id': '000006', 'name': 'Amelia', 'event': '活動', 'extra': {'SELLER': 'Doge', 'SALON': 'Velvet Tresses Salon', 'Licence'
2025-08-29 14:04:01,611 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:04:03,126 [INFO] app: [API] Append success for id=000006 name=Amelia
2025-08-29 14:04:03,174 [INFO] app: [API] 成功寫入：id=000006, name=Amelia
2025-08-29 14:04:03,184 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:04:03,187 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:04:05,080 [INFO] app: [API] Append success for id=000006 name=Amelia
2025-08-29 14:04:05,083 [INFO] app: [API] 成功寫入：id=000006, name=Amelia
2025-08-29 14:04:13,254 [INFO] app: 偵測到 QR：{'id': '000007', 'name': 'James', 'event': '活動', 'extra': {'SELLER': 'Doge', 'SALON': 'Velvet Tresses Salon', 'Licence':
2025-08-29 14:04:13,256 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:04:13,257 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:04:13,261 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:04:15,704 [INFO] app: [API] Append success for id=000007 name=James
2025-08-29 14:04:15,727 [INFO] app: [API] 成功寫入：id=000007, name=James
2025-08-29 14:04:19,144 [INFO] app: 偵測到 QR：{'id': '000008', 'name': 'Chloe', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Glow & Flow Hair Lounge', 'Licen
2025-08-29 14:04:19,145 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:04:19,146 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:04:19,148 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:04:21,410 [INFO] app: [API] Append success for id=000008 name=Chloe
2025-08-29 14:04:21,416 [INFO] app: [API] 成功寫入：id=000008, name=Chloe
2025-08-29 14:04:25,404 [INFO] app: 偵測到 QR：{'id': '000009', 'name': 'Daniel', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Glow & Flow Hair Lounge', 'Lice
2025-08-29 14:04:25,407 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:04:25,409 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:04:25,414 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:04:28,490 [INFO] app: [API] Append success for id=000009 name=Daniel
2025-08-29 14:04:28,507 [INFO] app: [API] 成功寫入：id=000009, name=Daniel
2025-08-29 14:04:35,518 [INFO] app: 偵測到 QR：{'id': '000011', 'name': 'Sophia', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Glow & Flow Hair Lounge', 'Lice
2025-08-29 14:04:35,521 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:04:35,523 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:04:35,529 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:04:38,350 [INFO] app: [API] Append success for id=000011 name=Sophia
2025-08-29 14:04:38,352 [INFO] app: [API] 成功寫入：id=000011, name=Sophia
2025-08-29 14:05:45,011 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 14:06:03,824 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:07:04,007 [INFO] app: 相機已停止
2025-08-29 14:07:06,627 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:07:27,372 [INFO] app: 相機已停止
2025-08-29 14:07:36,659 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:07:43,346 [INFO] app: 偵測到 QR：{'id': '000011', 'name': 'Sophia', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Glow & Flow Hair Lounge', 'Lice
2025-08-29 14:07:43,350 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:07:43,353 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:07:43,356 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:07:53,319 [INFO] app: 偵測到 QR：{'id': '000011', 'name': 'Sophia', 'event': '活動', 'extra': {'SELLER': 'Chris', 'SALON': 'Glow & Flow Hair Lounge', 'Lice
2025-08-29 14:07:53,320 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:07:53,340 [INFO] app: [API] 寫入逾時，跳過此筆並繼續下一筆（10s）
2025-08-29 14:07:53,341 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:07:53,342 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:07:59,060 [INFO] app: 開始上傳離線資料...
2025-08-29 14:07:59,064 [INFO] app: 沒有離線資料可上傳。
2025-08-29 14:08:03,344 [INFO] app: [API] 寫入逾時，跳過此筆並繼續下一筆（10s）
2025-08-29 14:11:43,782 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 14:11:55,884 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:12:07,414 [INFO] app: 相機已停止
2025-08-29 14:12:20,296 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:13:12,308 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 14:13:43,894 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:14:04,271 [INFO] app: 相機已停止
2025-08-29 14:14:09,792 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:15:31,068 [INFO] app: 相機已停止
2025-08-29 14:15:40,636 [INFO] app: 相機已停止
2025-08-29 14:15:49,660 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:16:03,096 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:16:03,097 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:16:03,098 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:16:03,100 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:16:13,090 [INFO] app: [API] 寫入逾時，跳過此筆並繼續下一筆（10s）
2025-08-29 14:19:07,573 [DEBUG] app: Logging initialized. Debug=True
2025-08-29 14:19:30,917 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:19:49,764 [INFO] app: 相機已停止
2025-08-29 14:19:51,797 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:20:04,038 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:20:04,040 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:20:04,043 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:20:04,049 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:20:14,040 [INFO] app: [API] 寫入逾時，跳過此筆並繼續下一筆（10s）
2025-08-29 14:20:29,317 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:20:29,318 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:20:29,319 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:20:29,322 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:20:30,169 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:20:30,186 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:20:35,590 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:20:35,591 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:20:35,592 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:20:35,595 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:20:36,332 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:20:36,352 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:20:37,404 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:20:37,405 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:20:37,406 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:20:37,410 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:20:38,278 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:20:38,285 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:20:41,574 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:20:41,576 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:20:41,578 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:20:41,580 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:20:42,460 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:20:42,466 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:21:20,503 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:21:20,506 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:21:50,314 [INFO] app: 開始上傳離線資料...
2025-08-29 14:21:55,340 [INFO] app: 離線資料上傳完成：成功 5/5
2025-08-29 14:22:14,447 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:22:14,448 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:22:14,449 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:22:14,450 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:22:15,235 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:22:15,262 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:22:16,036 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:22:16,038 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:22:16,040 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:22:16,046 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:22:17,035 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:22:17,065 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:22:17,617 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:22:17,618 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:22:17,619 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:22:17,621 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:22:18,418 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:22:18,426 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:22:30,879 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:22:30,881 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:22:30,882 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:22:30,885 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:22:31,687 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:22:31,698 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:22:32,518 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:22:32,520 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:22:32,521 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:22:32,524 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:22:33,335 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 52, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:22:33,346 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:22:41,888 [INFO] app: 開始上傳離線資料...
2025-08-29 14:22:46,518 [INFO] app: 離線資料上傳完成：成功 5/5
2025-08-29 14:27:28,783 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:27:39,758 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:27:39,760 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:27:39,764 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:27:39,769 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:27:42,372 [INFO] app: [API] Append success for id=000001 name=Ethan
2025-08-29 14:27:42,373 [INFO] app: [API] 成功寫入：id=000001, name=Ethan
2025-08-29 14:28:33,560 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:28:45,343 [INFO] app: 相機已停止
2025-08-29 14:28:53,999 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:29:22,942 [INFO] app: 相機已停止
2025-08-29 14:29:40,105 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:29:59,296 [INFO] app: 相機已停止
2025-08-29 14:30:07,493 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:30:28,114 [INFO] app: 相機已停止
2025-08-29 14:31:39,767 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:32:03,457 [INFO] app: 相機已停止
2025-08-29 14:32:05,038 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:32:08,337 [INFO] app: 相機已停止
2025-08-29 14:32:19,437 [INFO] app: 相機已啟動（索引 0），解析度：640x480
2025-08-29 14:32:40,153 [INFO] app: 相機已停止
2025-08-29 14:32:51,735 [INFO] app: 相機已啟動（索引 1），解析度：640x480
2025-08-29 14:33:00,971 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:00,975 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:00,981 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:00,992 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:02,209 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:33:02,213 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:33:02,225 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:33:07,208 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:07,209 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:07,210 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:07,211 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:07,920 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:33:07,926 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:33:07,929 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:33:09,026 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:09,029 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:09,030 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:09,033 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:09,764 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:33:09,765 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:33:09,766 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:33:11,746 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:11,747 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:11,748 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:11,753 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:12,580 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:33:12,581 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:33:12,584 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:33:24,054 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:24,056 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:24,058 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:24,062 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:26,488 [INFO] app: [API] Append success for id=000001 name=Ethan
2025-08-29 14:33:26,501 [INFO] app: [API] 成功寫入：id=000001, name=Ethan
2025-08-29 14:33:33,153 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:33,155 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:33,156 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:33,159 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:34,951 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:34,953 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:35,234 [INFO] app: [API] Append success for id=000001 name=Ethan
2025-08-29 14:33:35,241 [INFO] app: [API] 成功寫入：id=000001, name=Ethan
2025-08-29 14:33:35,249 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:35,253 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:37,134 [INFO] app: [API] Append success for id=000001 name=Ethan
2025-08-29 14:33:37,139 [INFO] app: [API] 成功寫入：id=000001, name=Ethan
2025-08-29 14:33:37,241 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:37,244 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:37,246 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:37,247 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:39,141 [INFO] app: [API] Append success for id=000001 name=Ethan
2025-08-29 14:33:39,144 [INFO] app: [API] 成功寫入：id=000001, name=Ethan
2025-08-29 14:33:40,909 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:40,910 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:40,911 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:40,913 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:41,793 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:41,794 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:42,881 [INFO] app: [API] Append success for id=000001 name=Ethan
2025-08-29 14:33:42,884 [INFO] app: [API] 成功寫入：id=000001, name=Ethan
2025-08-29 14:33:42,887 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:42,889 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:43,816 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:33:43,818 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:33:44,931 [INFO] app: [API] Append success for id=000001 name=Ethan
2025-08-29 14:33:44,933 [INFO] app: [API] 成功寫入：id=000001, name=Ethan
2025-08-29 14:33:44,943 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:33:44,945 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:33:46,940 [INFO] app: [API] Append success for id=000001 name=Ethan
2025-08-29 14:33:46,952 [INFO] app: [API] 成功寫入：id=000001, name=Ethan
2025-08-29 14:34:00,330 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:34:00,332 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:34:00,333 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:34:00,334 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:34:01,105 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:34:01,108 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:34:01,114 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:34:01,200 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:34:01,201 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:34:01,202 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:34:01,204 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:34:01,937 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:34:01,947 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:34:01,949 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:34:03,239 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:34:03,241 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:34:03,241 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:34:03,244 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:34:03,996 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:34:04,001 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:34:04,005 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:34:04,105 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:34:04,106 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:34:04,107 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:34:04,109 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:34:04,879 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:34:04,887 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:34:04,890 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:34:27,922 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:34:27,923 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:34:27,924 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:34:27,926 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:34:28,696 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:34:28,717 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:34:28,719 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:34:29,944 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:34:29,945 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:34:29,946 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:34:29,948 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:34:30,759 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:34:30,780 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:34:30,784 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
2025-08-29 14:34:32,376 [INFO] app: 偵測到 QR：{'id': '000001', 'name': 'Ethan', 'event': '活動', 'extra': {'SELLER': 'Tony', 'SALON': 'Luxe Locks Studio', 'Licence': 'y
2025-08-29 14:34:32,379 [INFO] app: 已加入佇列，待寫入（佇列長度 1）
2025-08-29 14:34:32,380 [INFO] app: [API] 開始寫入 Google Sheet ...
2025-08-29 14:34:32,384 [INFO] app: [API] Connecting to Google Sheet ...
2025-08-29 14:34:33,256 [WARNING] app: [API] Append failed, saved offline CSV. Error: Traceback (most recent call last):
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 168, in open_by_key
    spreadsheet = Spreadsheet(self.http_client, {"id": key})
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 29, in __init__
    metadata = self.fetch_sheet_metadata()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\spreadsheet.py", line 230, in fetch_sheet_metadata
    return self.client.fetch_sheet_metadata(self.id, params=params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 305, in fetch_sheet_metadata
    r = self.request("get", url, params=params)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\http_client.py", line 128, in request
    raise APIError(response)
gspread.exceptions.APIError: APIError: [-1]: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 404 (Not Found)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>404.</b> <ins>That’s an error.</ins>
  <p>The requested URL <code>/v4/spreadsheets/?includeGridData=false</code> was not found on this server.  <ins>That’s all we know.</ins>


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\Github\QRcode_Signin\app\ui.py", line 53, in run
    client.append_signin(self.payload)
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 60, in append_signin
    self.connect()
  File "d:\Github\QRcode_Signin\app\google_sheets.py", line 37, in connect
    sh = gc.open_by_key(self.spreadsheet_id)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Github\QRcode_Signin\.venv\Lib\site-packages\gspread\client.py", line 171, in open_by_key
    raise SpreadsheetNotFound(ex.response) from ex
gspread.exceptions.SpreadsheetNotFound: <Response [404]>

2025-08-29 14:34:33,262 [INFO] app: [OFFLINE] 已暫存本機 CSV：id=000001, name=Ethan
2025-08-29 14:34:33,264 [INFO] app: [API] 線上寫入失敗，已暫存至本機離線 CSV，稍後可點『上傳離線資料』再同步。
